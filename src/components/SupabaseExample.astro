---
// Access Supabase client from Astro locals
const { supabase } = Astro.locals;

// Example: Fetch data from a table
const { data: flashcards, error } = await supabase.from("flashcards").select("*").limit(5);

// Example: Get current user session
const {
  data: { session },
} = await supabase.auth.getSession();
---

<div class="p-4">
  <h2 class="text-2xl font-bold mb-4">Supabase Example</h2>

  <!-- Authentication Status -->
  <div class="mb-6">
    <h3 class="text-xl mb-2">Authentication Status</h3>
    {
      session ? (
        <p class="text-green-600">Logged in as: {session.user.email}</p>
      ) : (
        <p class="text-yellow-600">Not logged in</p>
      )
    }
  </div>

  <!-- Data Display -->
  <div>
    <h3 class="text-xl mb-2">Recent Posts</h3>
    {error && <p class="text-red-500">Error: {error.message}</p>}

    {
      flashcards && flashcards.length > 0 ? (
        <ul class="space-y-2">
          {flashcards.map((flashcard) => (
            <li class="p-2 bg-gray-100 rounded">
              <h4 class="font-semibold">{flashcard.front}</h4>
              <p class="text-sm text-gray-600">{flashcard.back}</p>
            </li>
          ))}
        </ul>
      ) : (
        <p class="text-gray-500">No flashcards found</p>
      )
    }
  </div>
</div>
